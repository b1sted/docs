---
title: "Лекция 3: Язык C: начальные сведения."
---

> _Я водку пробовал однажды, она не утолила жажды._

<hr class="custom-divider">

## Общая характеристика языка C

* **Популярность:** C — один из наиболее популярных языков программирования, который лёг в основу многих других языков (C++, Java, JavaScript, C# и др.).
* **Преимущества:** Высокая переносимость программ между платформами, сочетание низкоуровневых и высокоуровневых черт, возможность работы с операционными системами и микроконтроллерами.
* **История создания:** Разработан для замены ассемблера с упором на простоту реализации. Используется для низкоуровневого программирования, особенно в ядрах ОС и прошивках для микроконтроллеров.

<hr class="custom-divider">

## Структура программы на языке C

Программа на Си состоит из одной или нескольких функций. Основные элементы:

* **Директивы препроцессора**: Указания для препроцессора перед компиляцией. Пример: `#include <stdio.h>`.
* **Функция main()**: Обязательная функция, с которой начинается выполнение программы.

Пример простой программы на C:

```c
#include <stdio.h>  // Подключаем стандартную библиотеку ввода-вывода

int main(void) {  // Определяем функцию main, с которой начинается выполнение программы
    printf("Hello, World!\n");  // Выводим строку "Hello, World!" и перевод строки с помощью \n
    return 0;  // Завершаем программу и возвращаем 0, указывая на успешное выполнение
}
```

<hr class="custom-divider">

## Директивы препроцессора

* **Препроцессор** обрабатывает исходный код перед компиляцией. Команды начинаются с `#` и управляют подключением файлов, макроопределениями и условной компиляцией.
* **Основные директивы**:
  * `#include`: подключение заголовочных файлов.
  * `#define`: создание макроопределений.

Пример макроопределений:

```c
#define PI 3.1415927  // Определяем макрос PI, который заменяется на значение 3.1415927
#define HELLOMSG "Hello, World!\n"  // Определяем макрос HELLOMSG, который заменяется на строку "Hello, World!\n"
```

Необязательная пояснительная база от автора:

* `PI` — имя макроса, которое компилятор заменит на значение `3.1415927` везде, где встретит `PI` в коде:

```c
double circleArea = PI * radius * radius;
// Компилятор подставит 3.1415927 вместо PI
```

* `HELLOMSG` — имя макроса, которое будет заменено строкой `"Hello, World!\n"`. Символ  в конце строки добавляет перевод строки.

```c
printf(HELLOMSG);  
// Компилятор подставит "Hello, World!\n" вместо HELLOMSG
```

### Зачем использовать макросы?

Макросы удобны для хранения значений, которые могут повторяться в коде, поскольку они упрощают изменение значений и делают код более читаемым.

<hr class="custom-divider">

## Функции в Си

* **Функция** — это подпрограмма, выполняющая определённые действия. Она может возвращать значение и принимать аргументы.
* **Системные функции** хранятся в стандартных библиотеках, как `printf` и `scanf`.
* **Пользовательские функции** разрабатываются для выполнения конкретных подзадач.

Пример функции для сложения двух чисел:

```c
#include <stdio.h>

int sum(int x, int y) {
    return x + y;
}

int main() {
    int result = sum(5, 3);
    printf("Sum: %d\n", result);
    return 0;
}
```

<hr class="custom-divider">

## Основные средства ввода-вывода

* **Функция printf()**: Предназначена для форматированного вывода данных.
* **Функция scanf()**: Считывает данные с клавиатуры и преобразует их во внутренний формат.

Пример использования `printf` и `scanf`:

```c
#include <stdio.h>  // Подключаем стандартную библиотеку для ввода-вывода

int main() {  // Объявляем функцию main, с которой начинается выполнение программы
    int a;  // Объявляем целочисленную переменную a для хранения введённого числа

    printf("Введите число: ");  // Выводим сообщение с запросом на ввод числа
    scanf("%d", &a);  // Считываем введённое пользователем число и сохраняем его в переменную a
                      // %d — формат для целого числа, &a — адрес переменной, куда будет записано значение
    printf("Вы ввели: %d\n", a);  // Выводим введённое значение с переводом строки

    return 0;  // Завершаем выполнение программы, возвращая 0, что указывает на успешное завершение
}
```

### Недостатки функций printf() и scanf()

1. **Отсутствие проверки типов** в `printf()` может привести к ошибкам.
2. **Риск переполнения буфера** в `scanf()`, так как длина ввода не ограничена.
3. **Неинтуитивное поведение** `scanf()`, оставляющего символы в буфере.
4. **Ограниченная поддержка локалей**, что мешает работе с форматированием в разных языках.
5. **Сложности с форматированием сложных типов данных**.

Альтернативы:

* `snprintf()` для безопасного форматированного вывода строк в буферы.
* `fgets()` для безопасного считывания строк из ввода.
* `sscanf()` для разбора строк с контролем переполнения буфера.

Эти альтернативы позволяют лучше управлять памятью и делают код более защищённым от ошибок.

<hr class="custom-divider">

## Управляющие символы и форматы

* Управляющие символы, такие как `\n` (перевод строки) и `\t` (табуляция), используются в строках.
* Форматы вывода, например, `%d` для целых чисел, `%f` для чисел с плавающей точкой.

Пример программы с форматированным выводом:

```c
#include <stdio.h> // Подключаем библиотеку для ввода/вывода

int main() {
    // Объявляем переменную x типа float и инициализируем её значением 1.2345
    float x = 1.2345;

    // Выводим значение x на экран с форматированием:
    // %10.5f - это спецификатор формата
    // 10 - общее количество знаков в строке (включая запятую и пробелы)
    // .5 - количество знаков после запятой
    // f - указывает, что мы выводим число с плавающей запятой
    printf("x=%10.5f\n", x);

    return 0; // Возвращаем 0, что означает успешное завершение программы
}
```

<hr class="custom-divider">

## Компиляция и интерпретация

* **Компилируемые языки**: Программы на C компилируются в машинный код, что повышает эффективность.
* **Команда компиляции**: Например, для компиляции программы используется `gcc -Wall -g -o hello hello.c`.

??? note "Важный нюанс при компиляции с `<math.h>` в Linux и FreeBSD"
    При компиляции программы на C, использующей `<math.h>`, на Linux и FreeBSD необходимо указывать флаг `-lm`, иначе возникнут ошибки линковки. Это связано с тем, что в этих ОС математическая библиотека (`libm`) отделена от стандартной библиотеки C и требует явного подключения. На Windows это не требуется, так как `libm` встроена в стандартную библиотеку.

    `gcc -Wall -g -o example.out 1.c **-lm**`

<hr class="custom-divider">

## Интерфейс командной строки (CLI)

<figure markdown="span">
  ![CLI]
</figure>

CLI, например, в среде Linux, позволяет работать с компилятором и запускать программы через терминал.

<hr class="custom-divider">

> [_You bowin' down to the flag, you got a bullet in your head_](https://www.youtube.com/watch?v=kmZAsLMUuPw\&pp=ygUUYnVsbGV0IGluIHlvdXIgaGVhZCA%3D)

[CLI]: ../assets/images/cli.png
